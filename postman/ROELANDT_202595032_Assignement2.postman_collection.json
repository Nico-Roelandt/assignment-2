{
	"info": {
		"_postman_id": "cc3bf138-8863-4edb-95b0-2b04b8abe202",
		"name": "ROELANDT_202595032_Assignement2",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "49453946",
		"_collection_link": "https://nico-roelandt59-6740799.postman.co/workspace/Nicolas-Roelandt's-Workspace~f5573db9-bd04-475f-8888-f69761cfac68/collection/49453946-cc3bf138-8863-4edb-95b0-2b04b8abe202?action=share&source=collection_link&creator=49453946"
	},
	"item": [
		{
			"name": "BOOKS",
			"item": [
				{
					"name": "List books",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"200\", () => pm.response.code === 200);\r",
									"const j = pm.response.json();\r",
									"pm.test(\"has pagination fields\", () => {\r",
									"  pm.expect(j).to.have.property(\"content\");\r",
									"  pm.expect(j).to.have.property(\"page\");\r",
									"  pm.expect(j).to.have.property(\"size\");\r",
									"  pm.expect(j).to.have.property(\"totalElements\");\r",
									"  pm.expect(j).to.have.property(\"totalPages\");\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/books?page=0&size=10&sort=id,DESC",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"books"
							],
							"query": [
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "10"
								},
								{
									"key": "sort",
									"value": "id,DESC"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get a book",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/books/5",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"books",
								"5"
							]
						}
					},
					"response": []
				},
				{
					"name": "Add book",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const token = pm.environment.get(\"adminToken\");\r",
									"pm.request.headers.upsert({ key: \"Authorization\", value: `Bearer ${token}` });\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"title\": \"New Book\",\r\n  \"author\": \"Someone\",\r\n  \"publisher\": \"Demo Publisher\",\r\n  \"summary\": \"Short summary\",\r\n  \"isbn\": \"ISBN-NEW-12345\",\r\n  \"price\": 19.99,\r\n  \"publication_date\": \"2020-01-01\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/books",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"books"
							]
						}
					},
					"response": []
				},
				{
					"name": "Edit",
					"request": {
						"method": "PATCH",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"price\": 25.5,\r\n  \"summary\": \"Updated summary\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/books/2",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"books",
								"2"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "REVIEWS",
			"item": [
				{
					"name": "List of review of a book",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/books/2/reviews?page=0&size=10&sort=id,DESC",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"books",
								"2",
								"reviews"
							],
							"query": [
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "10"
								},
								{
									"key": "sort",
									"value": "id,DESC"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Create review",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{ \"rating\": 5, \"comment\": \"Nice book\" }\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/books/2/reviews",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"books",
								"2",
								"reviews"
							]
						}
					},
					"response": []
				},
				{
					"name": "Update review",
					"request": {
						"method": "PATCH",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{ \"rating\": 4, \"comment\": \"Still good\" }\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/reviews/54",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"reviews",
								"54"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete review",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/reviews/54",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"reviews",
								"54"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "ORDERS",
			"item": [
				{
					"name": "Create order",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{ \"book_id\": 2, \"quantity\": 2 }\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/orders",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"orders"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get orders",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/orders/me?page=0&size=10&sort=id,DESC",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"orders",
								"me"
							],
							"query": [
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "10"
								},
								{
									"key": "sort",
									"value": "id,DESC"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Admin list orders",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/orders?page=0&size=10&sort=id,DESC",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"orders"
							],
							"query": [
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "10"
								},
								{
									"key": "sort",
									"value": "id,DESC"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Admin change status order",
					"request": {
						"method": "PATCH",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{ \"status\": \"PAID\" }\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/orders/5/status",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"orders",
								"5",
								"status"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "CART",
			"item": [
				{
					"name": "Add item",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{ \"book_id\": 2, \"quantity\": 1 }\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/cart/items",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"cart",
								"items"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get card",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/cart",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"cart"
							]
						}
					},
					"response": []
				},
				{
					"name": "update card",
					"request": {
						"method": "PATCH",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{ \"quantity\": 3 }\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/cart/items/10",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"cart",
								"items",
								"10"
							]
						}
					},
					"response": []
				},
				{
					"name": "Remove item",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/cart/items/1",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"cart",
								"items",
								"1"
							]
						}
					},
					"response": []
				},
				{
					"name": "clear card",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/cart",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"cart"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "FAVORITE",
			"item": [
				{
					"name": "Add fav",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{ \"book_id\": 2 }\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/favorites",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"favorites"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get fav",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/favorites",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"favorites"
							]
						}
					},
					"response": []
				},
				{
					"name": "New Request",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/favorites/by-book/2",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"favorites",
								"by-book",
								"2"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "COUPONS",
			"item": [
				{
					"name": "List coupons",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/coupons?page=0&size=10&sort=id,DESC",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"coupons"
							],
							"query": [
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "10"
								},
								{
									"key": "sort",
									"value": "id,DESC"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Create coupon",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"code\": \"TEST10\",\r\n  \"coupon_amount\": 10,\r\n  \"start\": \"2024-01-01T00:00:00Z\",\r\n  \"end\": \"2026-01-01T00:00:00Z\",\r\n  \"is_valid\": true\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/coupons",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"coupons"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "DISCOUNTS",
			"item": [
				{
					"name": "List discount",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/discounts?bookId=2&page=0&size=10&sort=id,DESC",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"discounts"
							],
							"query": [
								{
									"key": "bookId",
									"value": "2"
								},
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "10"
								},
								{
									"key": "sort",
									"value": "id,DESC"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "New Request",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"book_id\": 2,\r\n  \"discount_rate\": 15,\r\n  \"start\": \"2024-01-01T00:00:00Z\",\r\n  \"end\": \"2026-01-01T00:00:00Z\",\r\n  \"is_valid\": true\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/discounts",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"discounts"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Health",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/health",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"health"
					]
				}
			},
			"response": []
		},
		{
			"name": "Login admin",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.environment.set(\"adminToken\", pm.response.json().accessToken);\r",
							"pm.test(\"200\", pm.environment.get(\"adminToken\"), () => pm.response.code === 200);"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{ \"email\": \"admin@example.com\", \"password\": \"password\" }\r\n",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/auth/login",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"auth",
						"login"
					]
				}
			},
			"response": []
		},
		{
			"name": "Login user",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.environment.set(\"accessToken\", pm.response.json().accessToken);\r",
							"\r",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{ \"email\": \"user1@example.com\", \"password\": \"password\" }\r\n",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/auth/login",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"auth",
						"login"
					]
				}
			},
			"response": []
		}
	],
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{accessToken}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					"const url = pm.request.url.toString();\r",
					"if (url.includes(\"/auth/login\") || url.includes(\"/health\") || (pm.request.method === \"GET\" && (url.includes(\"/books\") || url.includes(\"/coupons\") || url.includes(\"/discounts\")))) {\r",
					"} else {\r",
					"  const token = pm.environment.get(\"accessToken\");\r",
					"  if (token) pm.request.headers.upsert({ key: \"Authorization\", value: `Bearer ${token}` });\r",
					"}\r",
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": ""
		},
		{
			"key": "adminToken",
			"value": ""
		}
	]
}